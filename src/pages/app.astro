---
import Layout from '../layouts/Layout.astro';
import AppHeader from '../components/app/AppHeader.astro';
---

<Layout
  title="Reshrimp — Image Processor"
  description="Resize, convert, and compress images privately in your browser. No uploads, no tracking."
>
  <div class="page-pop">
    <AppHeader />

    <main class="sbs-main" transition:animate="fade">
      <div class="sbs-workspace">
        <!-- Left Panel: Upload + Controls -->
        <div class="sbs-panel-left">
          <div class="sbs-section">
            <div id="upload-area" class="sp-upload-area sbs-upload-area">
              <input
                type="file"
                id="file-input"
                accept="image/jpeg,image/png,image/webp,image/gif"
                class="hidden"
              />
              <div class="sp-upload-content">
                <div class="sbs-upload-actions">
                  <span class="sbs-upload-cta">
                    <svg
                      width="16"
                      height="16"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                      aria-hidden="true"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path>
                    </svg>
                    Choose file
                  </span>
                  <span class="sbs-upload-or">or drag and drop</span>
                </div>
                <p class="sp-upload-hint">JPEG, PNG, WebP, or GIF (max 50MB)</p>
              </div>
              <div id="file-info" class="sp-file-info hidden"></div>
              <div id="validation-message" class="hidden"></div>
            </div>
          </div>

          <!-- Future batch file list -->
          <div id="file-queue" class="sbs-file-queue hidden"></div>

          <!-- Processing Controls -->
          <div id="processing-controls" class="sbs-controls sbs-controls-inactive">
            <div class="sbs-control-group">
              <h4 class="sbs-control-title">Resize</h4>
              <div class="sbs-resize-grid">
                <label class="block">
                  <span class="sp-input-label">Width</span>
                  <input
                    type="number"
                    id="width-input"
                    class="sp-input"
                    min="1"
                    max="10000"
                    placeholder="Original"
                    disabled
                  />
                </label>
                <label class="block">
                  <span class="sp-input-label">Height</span>
                  <input
                    type="number"
                    id="height-input"
                    class="sp-input"
                    min="1"
                    max="10000"
                    placeholder="Original"
                    disabled
                  />
                </label>
              </div>
              <label class="sp-checkbox-label">
                <input
                  type="checkbox"
                  id="maintain-aspect-ratio"
                  checked
                  class="sp-checkbox"
                  disabled
                />
                <span>Lock aspect ratio</span>
              </label>
            </div>

            <div class="sbs-control-group">
              <h4 class="sbs-control-title">Format</h4>
              <div class="sp-select-wrapper">
                <select id="format-select" class="sp-select" disabled>
                  <option value="">Keep original</option>
                  <option value="image/jpeg">JPEG</option>
                  <option value="image/png">PNG</option>
                  <option value="image/webp">WebP</option>
                </select>
                <svg
                  class="sp-select-arrow"
                  width="12"
                  height="12"
                  viewBox="0 0 12 12"
                  fill="none"
                  stroke="currentColor"
                  aria-hidden="true"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M3 4.5l3 3 3-3"></path>
                </svg>
              </div>
            </div>

            <div class="sbs-control-group">
              <div class="sbs-quality-header">
                <h4 class="sbs-control-title">Quality</h4>
                <span id="quality-value" class="sbs-quality-val">92%</span>
              </div>
              <input
                type="range"
                id="quality-slider"
                min="0"
                max="100"
                value="92"
                class="sp-slider"
                disabled
              />
            </div>

            <button
              type="button"
              id="process-button"
              class="sp-process-btn sbs-process-btn"
              disabled
            >
              Process Image
            </button>
          </div>
        </div>

        <!-- Right Panel: Preview -->
        <div class="sbs-panel-right">
          <div class="sbs-preview-empty" id="sbs-empty-state">
            <svg class="sbs-empty-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.5"
                d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
              ></path>
            </svg>
            <p class="sbs-empty-text">Upload an image to get started</p>
            <p class="sbs-empty-hint">Your preview will appear here</p>
          </div>

          <div id="preview-container" class="sbs-preview hidden">
            <div class="sbs-preview-tabs">
              <button type="button" class="sbs-tab sbs-tab-active" data-tab="original">
                Original
              </button>
              <button type="button" class="sbs-tab" data-tab="processed">Processed</button>
            </div>

            <div class="sbs-tab-content">
              <div class="sbs-tab-panel sbs-tab-panel-active" data-tabpanel="original">
                <div class="sbs-preview-frame">
                  <img id="original-preview" alt="Original" class="sp-preview-img" />
                </div>
                <div id="original-info" class="sbs-info">
                  <p id="original-dimensions"></p>
                  <p id="original-size"></p>
                </div>
              </div>

              <div class="sbs-tab-panel" data-tabpanel="processed">
                <div class="sbs-preview-frame">
                  <div id="processed-placeholder" class="sp-preview-placeholder">
                    <svg
                      class="sp-placeholder-icon"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="1.5"
                        d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                      ></path>
                    </svg>
                    <p class="sp-placeholder-text">Process to see result</p>
                  </div>
                  <img id="processed-preview" alt="Processed" class="sp-preview-img hidden" />
                </div>
                <div id="processed-info" class="sbs-info hidden">
                  <p id="processed-dimensions"></p>
                  <p id="processed-size"></p>
                  <p id="size-difference"></p>
                </div>
              </div>
            </div>

            <div id="error-message" class="sp-error hidden">
              <div class="sp-error-inner">
                <svg class="sp-error-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <div>
                  <h3 class="sp-error-title">Processing Error</h3>
                  <p id="error-text" class="sp-error-text"></p>
                </div>
              </div>
            </div>

            <div id="download-section" class="sbs-download sbs-download-inactive">
              <button id="download-button" disabled class="sp-download-btn">
                <svg class="sp-download-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                </svg>
                <span>Download</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</Layout>

<script>
  import { ImageProcessorController } from '../lib/imageProcessor';

  let controller: ImageProcessorController | null = null;

  function initSideBySide() {
    if (!document.getElementById('upload-area')) return;
    controller?.cleanup();
    controller = new ImageProcessorController();

    // Tab switching
    document.querySelectorAll('.sbs-tab').forEach((tab) => {
      tab.addEventListener('click', () => {
        const target = (tab as HTMLElement).dataset.tab;
        document.querySelectorAll('.sbs-tab').forEach((t) => t.classList.remove('sbs-tab-active'));
        document
          .querySelectorAll('.sbs-tab-panel')
          .forEach((p) => p.classList.remove('sbs-tab-panel-active'));
        tab.classList.add('sbs-tab-active');
        document
          .querySelector(`.sbs-tab-panel[data-tabpanel="${target}"]`)
          ?.classList.add('sbs-tab-panel-active');
      });
    });

    // Hide empty state when preview appears
    const preview = document.getElementById('preview-container');
    const emptyState = document.getElementById('sbs-empty-state');
    if (preview && emptyState) {
      new MutationObserver(() => {
        if (!preview.classList.contains('hidden')) {
          emptyState.style.opacity = '0';
          setTimeout(() => {
            emptyState.style.display = 'none';
          }, 300);
        }
      }).observe(preview, { attributes: true, attributeFilter: ['class'] });
    }

    // Auto-switch to processed tab when download becomes available
    const downloadSection = document.getElementById('download-section');
    if (downloadSection) {
      new MutationObserver(() => {
        if (!downloadSection.classList.contains('sbs-download-inactive')) {
          const processedTab = document.querySelector('.sbs-tab[data-tab="processed"]');
          processedTab?.dispatchEvent(new Event('click'));
        }
      }).observe(downloadSection, { attributes: true, attributeFilter: ['class'] });
    }
  }

  document.addEventListener('astro:page-load', initSideBySide);
  document.addEventListener('astro:before-preparation', () => {
    controller?.cleanup();
    controller = null;
  });
</script>

<style>
  .sbs-main {
    position: relative;
    z-index: 1;
  }

  /* ===== Workspace Layout ===== */
  .sbs-workspace {
    display: grid;
    grid-template-columns: 360px 1fr;
    gap: 1.5rem;
    max-width: 1400px;
    margin: 0 auto;
    padding: 1rem 2rem 1.5rem;
    min-height: calc(100vh - 52px);
  }

  /* ===== Left Panel ===== */
  .sbs-panel-left {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    position: sticky;
    top: 70px;
    align-self: start;
    min-height: calc(100vh - 86px);
  }

  /* ===== Upload Area ===== */
  .sp-upload-area {
    background: var(--sp-bg-card);
    border: 2px dashed var(--sp-border);
    border-radius: var(--sp-radius-xl);
    padding: 1.5rem 1.25rem;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
    box-shadow: var(--sp-shadow);
  }

  .sp-upload-area:hover {
    border-color: var(--sp-lavender);
  }

  .sp-upload-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.75rem;
  }

  .sbs-upload-actions {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.4rem;
  }

  .sbs-upload-cta {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    background: var(--sp-coral);
    color: #fff;
    padding: 0.55rem 1.2rem;
    border-radius: var(--sp-radius-full);
    font-size: 0.85rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
  }

  .sbs-upload-cta:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(255, 111, 97, 0.3);
  }

  .sbs-upload-or {
    font-size: 0.8rem;
    color: var(--sp-text-muted);
  }

  .sp-upload-hint {
    font-size: 0.8rem;
    color: var(--sp-text-soft);
    margin: 0;
  }

  .sp-file-info {
    margin-top: 0.75rem;
    font-size: 0.8rem;
    color: var(--sp-text-muted);
  }

  :global(#file-info:not(.hidden)) {
    background: var(--sp-lavender-light);
    border-radius: var(--sp-radius);
    padding: 0.4rem 0.75rem;
  }

  /* Drag active state */
  :global(.sp-upload-area.sp-drag-active) {
    border-color: var(--sp-lavender);
    background: var(--sp-lavender-light);
    transform: scale(1.01);
  }

  /* File queue (future bulk processing) */
  .sbs-file-queue {
    display: none;
  }

  /* ===== Controls ===== */
  .sbs-controls {
    background: var(--sp-bg-card);
    border: 1px solid var(--sp-border);
    border-radius: var(--sp-radius-xl);
    padding: 1.5rem;
    box-shadow: var(--sp-shadow);
    display: flex;
    flex-direction: column;
    gap: 1.25rem;
    flex: 1;
  }

  .sbs-controls-inactive {
    opacity: 0.4;
    pointer-events: none;
    filter: grayscale(0.3);
    transition:
      opacity 0.4s ease,
      filter 0.4s ease;
  }

  .sbs-controls:not(.sbs-controls-inactive) {
    transition:
      opacity 0.4s ease,
      filter 0.4s ease;
  }

  .sbs-control-group {
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
  }

  .sbs-control-group + .sbs-control-group {
    border-top: 1px solid var(--sp-border-light);
    padding-top: 1.25rem;
  }

  .sbs-control-title {
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--sp-text);
    margin: 0;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .sbs-resize-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.75rem;
  }

  .sbs-quality-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .sbs-quality-val {
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--sp-text-muted);
  }

  /* Form controls */
  .sp-input-label {
    display: block;
    font-size: 0.8rem;
    color: var(--sp-text-muted);
    margin-bottom: 0.3rem;
  }

  .sp-input {
    width: 100%;
    padding: 0.55rem 0.75rem;
    border: 1px solid var(--sp-border);
    border-radius: var(--sp-radius);
    font-family: var(--sp-font-body);
    font-size: 0.85rem;
    color: var(--sp-text);
    background: var(--sp-bg);
    transition:
      border-color 0.2s,
      box-shadow 0.2s;
  }

  .sp-input:focus {
    outline: none;
    border-color: var(--sp-lavender);
    box-shadow: 0 0 0 3px rgba(167, 139, 250, 0.15);
  }

  .sp-checkbox-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.8rem;
    color: var(--sp-text-muted);
    cursor: pointer;
  }

  .sp-checkbox {
    width: 1rem;
    height: 1rem;
    accent-color: var(--sp-lavender);
    cursor: pointer;
  }

  .sp-select-wrapper {
    position: relative;
  }

  .sp-select {
    width: 100%;
    padding: 0.55rem 2.25rem 0.55rem 0.75rem;
    border: 1px solid var(--sp-border);
    border-radius: var(--sp-radius);
    font-family: var(--sp-font-body);
    font-size: 0.85rem;
    color: var(--sp-text);
    background: var(--sp-bg);
    appearance: none;
    -webkit-appearance: none;
    transition:
      border-color 0.2s,
      box-shadow 0.2s;
    cursor: pointer;
  }

  .sp-select:focus {
    outline: none;
    border-color: var(--sp-lavender);
    box-shadow: 0 0 0 3px rgba(167, 139, 250, 0.15);
  }

  .sp-select-arrow {
    position: absolute;
    right: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--sp-lavender);
    pointer-events: none;
    transition: transform 0.2s ease;
  }

  .sp-select:focus ~ .sp-select-arrow {
    transform: translateY(-50%) rotate(180deg);
    color: var(--sp-lavender-dark);
  }

  .sp-slider {
    width: 100%;
    height: 6px;
    border-radius: 3px;
    appearance: none;
    -webkit-appearance: none;
    background: var(--sp-border-light);
    cursor: pointer;
  }

  .sp-slider::-webkit-slider-thumb {
    appearance: none;
    -webkit-appearance: none;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: var(--sp-coral);
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(255, 107, 107, 0.3);
  }

  .sp-slider::-moz-range-thumb {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background: var(--sp-coral);
    border: none;
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(255, 107, 107, 0.3);
  }

  /* Process button */
  .sp-process-btn {
    width: 100%;
    padding: 0.75rem 1.5rem;
    font-family: var(--sp-font-body);
    font-size: 0.9rem;
    font-weight: 600;
    color: #fff;
    background: var(--sp-coral);
    border: none;
    border-radius: var(--sp-radius-full);
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 4px 16px rgba(255, 107, 107, 0.3);
    margin-top: 0.5rem;
  }

  .sp-process-btn:hover:not(:disabled) {
    background: var(--sp-coral-dark);
    transform: translateY(-2px) scale(1.01);
    box-shadow: 0 6px 24px rgba(255, 107, 107, 0.4);
  }

  .sp-process-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
  }

  /* Inline button loading state */
  :global(.sp-process-btn-loading) {
    display: flex !important;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    pointer-events: none;
  }

  :global(.sp-btn-spinner) {
    width: 1rem;
    height: 1rem;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-top-color: #fff;
    border-radius: 50%;
    animation: btn-spin 0.6s linear infinite;
  }

  @keyframes btn-spin {
    to {
      transform: rotate(360deg);
    }
  }

  /* ===== Right Panel ===== */
  .sbs-panel-right {
    background: var(--sp-bg-card);
    border: 1px solid var(--sp-border);
    border-radius: var(--sp-radius-xl);
    box-shadow: var(--sp-shadow);
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  .sbs-preview-empty {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 2rem;
  }

  .sbs-empty-icon {
    width: 4rem;
    height: 4rem;
    color: var(--sp-lavender);
    opacity: 0.4;
    margin-bottom: 1rem;
    animation: sbs-float 3s ease-in-out infinite;
  }

  @keyframes sbs-float {
    0%,
    100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-8px);
    }
  }

  .sbs-empty-text {
    font-family: var(--sp-font-display);
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--sp-text-soft);
    margin: 0 0 0.25rem;
  }

  .sbs-empty-hint {
    font-size: 0.85rem;
    color: var(--sp-text-soft);
    opacity: 0.7;
    margin: 0;
  }

  .sbs-preview {
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  .sbs-preview.hidden {
    display: none;
  }

  /* ===== Tabs ===== */
  .sbs-preview-tabs {
    display: flex;
    border-bottom: 1px solid var(--sp-border-light);
    padding: 0 1rem;
    flex-shrink: 0;
  }

  .sbs-tab {
    padding: 0.85rem 1.25rem;
    font-family: var(--sp-font-body);
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--sp-text-muted);
    background: none;
    border: none;
    border-bottom: 2px solid transparent;
    cursor: pointer;
    transition: all 0.2s;
  }

  .sbs-tab:hover {
    color: var(--sp-text);
  }

  .sbs-tab-active {
    color: var(--sp-coral);
    border-bottom-color: var(--sp-coral);
    font-weight: 600;
  }

  /* Tab content container — fixed height to prevent layout shifts */
  .sbs-tab-content {
    flex: 1;
    position: relative;
    min-height: 380px;
  }

  .sbs-tab-panel {
    position: absolute;
    inset: 0;
    padding: 1.25rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    opacity: 0;
    visibility: hidden;
    transition:
      opacity 0.25s ease,
      visibility 0.25s ease;
  }

  .sbs-tab-panel-active {
    opacity: 1;
    visibility: visible;
  }

  /* ===== Preview Frames ===== */
  .sbs-preview-frame {
    flex: 1;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: var(--sp-bg);
    background-image:
      linear-gradient(45deg, #e8e6f0 25%, transparent 25%),
      linear-gradient(-45deg, #e8e6f0 25%, transparent 25%),
      linear-gradient(45deg, transparent 75%, #e8e6f0 75%),
      linear-gradient(-45deg, transparent 75%, #e8e6f0 75%);
    background-size: 16px 16px;
    background-position:
      0 0,
      0 8px,
      8px -8px,
      -8px 0;
    border: 1px solid var(--sp-border-light);
    border-radius: var(--sp-radius);
  }

  .sp-preview-img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
  }

  .sp-preview-img.hidden {
    display: none;
  }

  .sp-preview-placeholder {
    text-align: center;
    color: var(--sp-text-soft);
    padding: 2rem;
  }

  .sp-preview-placeholder.hidden {
    display: none;
  }

  .sp-placeholder-icon {
    width: 3rem;
    height: 3rem;
    margin: 0 auto 0.5rem;
    color: var(--sp-lavender);
    opacity: 0.5;
  }

  .sp-placeholder-text {
    font-size: 0.85rem;
    margin: 0;
  }

  .sbs-info {
    font-size: 0.78rem;
    color: var(--sp-text-muted);
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 0.15rem 0.5rem;
    flex-shrink: 0;
  }

  .sbs-info p {
    margin: 0;
  }

  .sbs-info p:not(:last-child)::after {
    content: '\00b7';
    margin-left: 0.5rem;
    color: var(--sp-border);
  }

  /* ===== Error ===== */
  .sp-error {
    background: var(--sp-coral-light);
    border: 1px solid rgba(255, 107, 107, 0.2);
    border-radius: var(--sp-radius);
    padding: 1rem 1.25rem;
    margin: 0 1.25rem;
  }

  .sp-error.hidden {
    display: none;
  }

  .sp-error-inner {
    display: flex;
    gap: 0.75rem;
  }

  .sp-error-icon {
    width: 1.25rem;
    height: 1.25rem;
    color: var(--sp-coral);
    flex-shrink: 0;
    margin-top: 0.1rem;
  }

  .sp-error-title {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--sp-coral-dark);
    margin: 0 0 0.25rem;
  }

  .sp-error-text {
    font-size: 0.8rem;
    color: var(--sp-coral);
    margin: 0;
  }

  /* ===== Download ===== */
  .sbs-download {
    border-top: 1px solid var(--sp-border-light);
    padding: 1rem 1.25rem;
    flex-shrink: 0;
  }

  .sbs-download-inactive {
    opacity: 0.3;
    pointer-events: none;
    transition: opacity 0.4s ease;
  }

  .sbs-download:not(.sbs-download-inactive) {
    transition: opacity 0.4s ease;
  }

  .sp-download-btn {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    font-family: var(--sp-font-body);
    font-size: 0.9rem;
    font-weight: 600;
    color: #fff;
    background: var(--sp-mint);
    border: none;
    border-radius: var(--sp-radius-full);
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 4px 16px rgba(45, 212, 191, 0.3);
  }

  .sp-download-btn:hover:not(:disabled) {
    background: var(--sp-mint-dark);
    transform: translateY(-2px) scale(1.01);
    box-shadow: 0 6px 24px rgba(45, 212, 191, 0.4);
  }

  .sp-download-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    transform: none;
  }

  .sp-download-icon {
    width: 1.25rem;
    height: 1.25rem;
  }

  /* ===== Animations ===== */
  @keyframes sbs-fade-in {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes sbs-slide-in {
    from {
      opacity: 0;
      transform: translateY(8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .sbs-preview:not(.hidden) {
    animation: sbs-fade-in 0.35s ease;
  }

  .sp-error:not(.hidden) {
    animation: sbs-slide-in 0.3s ease;
  }

  .sbs-preview-empty {
    transition: opacity 0.3s ease;
  }

  /* ===== Tablet breakpoint ===== */
  @media (max-width: 1023px) {
    .sbs-workspace {
      grid-template-columns: 300px 1fr;
      padding: 1rem 1.5rem 1.5rem;
    }

    .sbs-tab-content {
      min-height: 300px;
    }
  }

  /* ===== Phone breakpoint ===== */
  @media (max-width: 768px) {
    .sbs-workspace {
      grid-template-columns: 1fr;
      padding: 0.75rem 1rem 1.5rem;
    }

    .sbs-panel-left {
      position: static;
    }

    .sbs-tab-content {
      min-height: 250px;
    }
  }
</style>
